<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>299.fm</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden}
body{background:#F5F2EC;font-family:'Cormorant Garamond',serif;font-weight:300;color:#2A2A28;display:flex;align-items:center;justify-content:center}
#word{font-size:clamp(4rem,12vw,9rem);letter-spacing:.04em;user-select:none;position:relative;z-index:1}
#word span{display:inline-block;transition:color .4s,text-shadow .4s}
#word span.glow{color:#FFD93D;text-shadow:0 0 18px rgba(255,217,61,.45)}
canvas#bug{position:fixed;top:0;left:0;width:100%;height:100%;z-index:2;pointer-events:none}
#info-btn{position:fixed;bottom:24px;right:28px;z-index:10;width:28px;height:28px;border-radius:50%;border:1px solid rgba(42,42,40,.25);background:transparent;color:#2A2A28;font-family:'Cormorant Garamond',serif;font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:.4;transition:opacity .3s}
#info-btn:hover{opacity:.8}
#overlay{position:fixed;inset:0;background:rgba(245,242,236,.97);z-index:20;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .5s}
#overlay.open{opacity:1;pointer-events:auto}
#overlay-inner{text-align:center;font-size:clamp(1.1rem,3vw,1.6rem);line-height:2.2}
#overlay-inner .line{opacity:0;transform:translateY(8px);transition:opacity .6s,transform .6s}
#overlay.open .line{opacity:1;transform:translateY(0)}
#close-btn{position:absolute;top:24px;right:28px;background:none;border:none;font-size:24px;color:#2A2A28;cursor:pointer;opacity:.4;font-family:'Cormorant Garamond',serif}
#close-btn:hover{opacity:.8}
#interact-layer{position:fixed;inset:0;z-index:3}
@media(prefers-reduced-motion:reduce){#word span.glow-static{color:#FFD93D;text-shadow:0 0 18px rgba(255,217,61,.45)}}
</style>
</head>
<body>
<div id="word"></div>
<canvas id="bug"></canvas>
<div id="interact-layer"></div>
<button id="info-btn" aria-label="Info">i</button>
<div id="overlay">
<button id="close-btn" aria-label="Close">×</button>
<div id="overlay-inner">
<div class="line">299,792,458 metres per second.</div>
<div class="line"><br></div>
<div class="line">Be Present</div>
<div class="line">Be Bold</div>
<div class="line">Be Together</div>
<div class="line"><br></div>
<div class="line">⚡</div>
</div>
</div>
<script>
// --- Word setup ---
const wordEl=document.getElementById('word');
const letters='Light'.split('');
letters.forEach((ch,i)=>{const s=document.createElement('span');s.textContent=ch;s.dataset.i=i;wordEl.appendChild(s)});
const spans=wordEl.querySelectorAll('span');

// --- Reduced motion ---
const reduced=window.matchMedia('(prefers-reduced-motion: reduce)').matches;
if(reduced){spans[2].classList.add('glow-static')}

// --- Info panel ---
const overlay=document.getElementById('overlay');
const lines=overlay.querySelectorAll('.line');
document.getElementById('info-btn').onclick=()=>{overlay.classList.add('open');lines.forEach((l,i)=>{l.style.transitionDelay=(.15*i)+'s'})};
document.getElementById('close-btn').onclick=()=>{overlay.classList.remove('open');lines.forEach(l=>{l.style.transitionDelay='0s'})};

if(reduced) { /* stop here, no animation */ }
else{

// --- Canvas ---
const cvs=document.getElementById('bug');
const ctx=cvs.getContext('2d');
let W,H;
function resize(){W=cvs.width=window.innerWidth;H=cvs.height=window.innerHeight}
resize();window.addEventListener('resize',resize);

// --- Bug state ---
const bug={
  x:-40,y:H/2,
  tx:W/2,ty:H/2,
  vx:0,vy:0,
  phase:'enter', // enter, fly, land, hover, startle
  timer:0,
  wingPhase:0,
  glow:1,
  landedOn:-1,
  facing:1 // 1=right,-1=left
};

// Letter positions
function getLetterRects(){
  const rects=[];
  spans.forEach(s=>{const r=s.getBoundingClientRect();rects.push({x:r.left+r.width/2,y:r.top+r.height*.35,w:r.width,h:r.height})});
  return rects;
}

// Mouse/touch tracking
let mouseX=-9999,mouseY=-9999;
const interactLayer=document.getElementById('interact-layer');
interactLayer.addEventListener('mousemove',e=>{mouseX=e.clientX;mouseY=e.clientY});
interactLayer.addEventListener('touchstart',e=>{const t=e.touches[0];mouseX=t.clientX;mouseY=t.clientY},{passive:true});
interactLayer.addEventListener('touchmove',e=>{const t=e.touches[0];mouseX=t.clientX;mouseY=t.clientY},{passive:true});
interactLayer.addEventListener('touchend',()=>{setTimeout(()=>{mouseX=-9999;mouseY=-9999},1200)},{passive:true});

function randRange(a,b){return a+Math.random()*(b-a)}

function pickTarget(){
  const rects=getLetterRects();
  // 40% chance land on letter, 60% random hover
  if(Math.random()<.4&&rects.length){
    const i=Math.floor(Math.random()*rects.length);
    bug.landedOn=i;
    return{x:rects[i].x,y:rects[i].y-10,land:true,letterIdx:i};
  }
  bug.landedOn=-1;
  return{x:randRange(W*.15,W*.85),y:randRange(H*.2,H*.8),land:false,letterIdx:-1};
}

function startFly(){
  const t=pickTarget();
  bug.tx=t.x;bug.ty=t.y;
  bug.phase=t.land?'flyToLand':'fly';
  bug.timer=0;
  bug.targetLetter=t.letterIdx;
}

function startle(){
  bug.phase='startle';
  bug.timer=0;
  // fly away from mouse
  const angle=Math.atan2(bug.y-mouseY,bug.x-mouseX);
  bug.tx=bug.x+Math.cos(angle)*randRange(150,300);
  bug.ty=bug.y+Math.sin(angle)*randRange(100,200);
  bug.tx=Math.max(40,Math.min(W-40,bug.tx));
  bug.ty=Math.max(40,Math.min(H-40,bug.ty));
  bug.landedOn=-1;
  // unglow letters
  spans.forEach(s=>s.classList.remove('glow'));
}

// Trail particles
const trail=[];

// --- Draw bug ---
function drawBug(dt){
  const s=20; // size
  const cx=bug.x,cy=bug.y;
  const flying=bug.phase!=='land';
  const glowAmt=flying?(.7+.3*Math.sin(Date.now()*.005)):(.3+.15*Math.sin(Date.now()*.003));

  ctx.save();
  ctx.translate(cx,cy);
  ctx.scale(bug.facing,1);

  // Glow aura
  const grad=ctx.createRadialGradient(3,-1,2,3,-1,s*1.2);
  grad.addColorStop(0,`rgba(255,217,61,${glowAmt*.5})`);
  grad.addColorStop(1,'rgba(255,217,61,0)');
  ctx.fillStyle=grad;
  ctx.beginPath();ctx.arc(3,-1,s*1.2,0,Math.PI*2);ctx.fill();

  // Wings (when flying)
  if(flying){
    bug.wingPhase+=dt*25;
    const wAng=Math.sin(bug.wingPhase)*.4;
    ctx.save();
    ctx.globalAlpha=.18;
    ctx.fillStyle='#2A2A28';
    // top wing
    ctx.save();ctx.translate(-2,-4);ctx.rotate(-.6+wAng);
    ctx.beginPath();ctx.ellipse(0,-5,3.5,8,0,0,Math.PI*2);ctx.fill();
    ctx.restore();
    // bottom wing
    ctx.save();ctx.translate(-2,-2);ctx.rotate(-.3-wAng*.7);
    ctx.beginPath();ctx.ellipse(0,-4,3,7,0,0,Math.PI*2);ctx.fill();
    ctx.restore();
    ctx.restore();
  }else{
    // Folded wings
    ctx.save();ctx.globalAlpha=.1;ctx.fillStyle='#2A2A28';
    ctx.beginPath();ctx.ellipse(-2,-6,2.5,7,-.15,0,Math.PI*2);ctx.fill();
    ctx.restore();
  }

  // Body
  ctx.fillStyle='#2A2A28';
  ctx.beginPath();ctx.ellipse(0,0,3.5,6,.1,0,Math.PI*2);ctx.fill();

  // Abdomen glow
  ctx.fillStyle=`rgba(255,217,61,${glowAmt})`;
  ctx.beginPath();ctx.ellipse(4,1,3,4,0,0,Math.PI*2);ctx.fill();

  // Antennae
  ctx.strokeStyle='#2A2A28';ctx.lineWidth=.6;
  ctx.beginPath();ctx.moveTo(-3,-5);ctx.quadraticCurveTo(-6,-12,-8,-14);ctx.stroke();
  ctx.beginPath();ctx.moveTo(-2,-5);ctx.quadraticCurveTo(-3,-13,-5,-15);ctx.stroke();

  ctx.restore();

  // Trail
  if(flying&&Math.random()<.3){
    trail.push({x:cx+bug.facing*5,y:cy+1,a:.3,life:1});
  }
}

function drawTrail(){
  for(let i=trail.length-1;i>=0;i--){
    const p=trail[i];
    p.life-=.008;p.a=p.life*.25;
    if(p.life<=0){trail.splice(i,1);continue}
    ctx.fillStyle=`rgba(255,217,61,${p.a})`;
    ctx.beginPath();ctx.arc(p.x,p.y,1.5*p.life,0,Math.PI*2);ctx.fill();
  }
}

// --- Update ---
let lastTime=0;
function update(now){
  const dt=Math.min((now-(lastTime||now))/1000,.05);
  lastTime=now;

  ctx.clearRect(0,0,W,H);

  // Check mouse proximity for startle
  if(bug.phase!=='startle'&&bug.phase!=='enter'){
    const dx=bug.x-mouseX,dy=bug.y-mouseY;
    if(Math.sqrt(dx*dx+dy*dy)<120){startle()}
  }

  // State machine
  switch(bug.phase){
    case 'enter':
      bug.timer+=dt;
      if(bug.timer<1.5){break}// wait
      bug.tx=W/2;bug.ty=H/2-20;
      moveBug(dt,2);
      if(distToTarget()<5){startFly()}
      break;
    case 'fly':
    case 'flyToLand':
    case 'startle':
      moveBug(dt,bug.phase==='startle'?4:1.8);
      if(distToTarget()<(bug.phase==='flyToLand'?4:15)){
        if(bug.phase==='flyToLand'){
          bug.phase='land';bug.timer=0;
          if(bug.targetLetter>=0)spans[bug.targetLetter].classList.add('glow');
        }else{
          bug.phase='hover';bug.timer=0;
        }
      }
      break;
    case 'hover':
      // gentle bob
      bug.y+=Math.sin(now*.002)*.15;
      bug.x+=Math.sin(now*.0013)*.1;
      bug.timer+=dt;
      if(bug.timer>randRange(2,5)){startFly()}
      break;
    case 'land':
      // sit still, pulse
      bug.timer+=dt;
      if(bug.timer>randRange(2.5,5)){
        if(bug.targetLetter>=0)spans[bug.targetLetter].classList.remove('glow');
        startFly();
      }
      break;
  }

  // Face direction of movement
  if(Math.abs(bug.vx)>.1)bug.facing=bug.vx>0?1:-1;

  drawTrail();
  drawBug(dt);
  requestAnimationFrame(update);
}

function moveBug(dt,speed){
  const dx=bug.tx-bug.x,dy=bug.ty-bug.y;
  const d=Math.sqrt(dx*dx+dy*dy)||1;
  // Add jitter for organic feel
  const jx=(Math.random()-.5)*40*dt;
  const jy=(Math.random()-.5)*40*dt;
  const ax=(dx/d)*speed*60+jx;
  const ay=(dy/d)*speed*60+jy;
  bug.vx+=(ax-bug.vx)*dt*2;
  bug.vy+=(ay-bug.vy)*dt*2;
  bug.x+=bug.vx*dt;
  bug.y+=bug.vy*dt;
}

function distToTarget(){
  const dx=bug.tx-bug.x,dy=bug.ty-bug.y;
  return Math.sqrt(dx*dx+dy*dy);
}

// Start after brief pause
setTimeout(()=>{bug.timer=0;requestAnimationFrame(update)},200);

} // end reduced motion check
</script>
</body>
</html>
